#!/usr/bin/env python
# main driver to interpret IGs

import ply.lex as lex
import ig_package.lexerIG as lexerIG
import ply.yacc as yacc
import ig_package.parserIG as parserIG
import ig_package.statics as statics
import ig_package.dynamics as dynamics

import sys

lexer = lex.lex(module=lexerIG)
parser = yacc.yacc(module=parserIG)

if __name__ == "__main__":
  if len(sys.argv) != 2:
    print "Use: main.py <IG program>"
    exit(1)
  try:
    igfile = open(sys.argv[1], "r")
    igcode = igfile.read()
  except Exception as e:
    print e
    print "Could not open file for reading!"
    exit(1)
  ast = parser.parse(igcode)
  assert(statics.valid(ast))
  dynamics.eval(ast)
  igfile.close()
